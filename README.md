# Сравнение калькуляций

WPF‑приложение для Windows, которое сравнивает две Excel-калькуляции, группирует строки по продукции и показывает агрегированные изменения по каждой группе. 

## Основные возможности

- Выбор двух входных файлов через стандартные диалоги Windows и отображение путей в интерфейсе приложения.
- Таблица различий с колонками для старых и новых значений (количество, цена, сумма), рассчитанными дельтами и процентным изменением.
- Группировка позиций по продукции с автоматическим расчётом итогов; группы, в которых изменение суммы меньше 5 %, скрываются как несущественные.
- Формирование статуса для каждой строки (`Добавлено`, `Удалено`, `Изменено`, `Без изменений`) для наглядного анализа.
- Экспорт результирующей таблицы в новый Excel-файл c заголовками, разделителями по продукции, суммарными строками и автонастройкой ширины столбцов.
- Корректная обработка числовых значений, записанных с пробелами или в разных форматах (текущая культура, `ru-RU`, инвариантная).

## Требования

- Windows с установленным .NET SDK 8.0 (проект таргетирует `net8.0-windows`).
- Поддержка WPF (`UseWPF` включён в проект).
- Пакет ClosedXML подключается автоматически при выполнении `dotnet restore`.

## Установка и запуск

1. Восстановите зависимости:
   ```bash
   dotnet restore
2. Соберите решение:
   ```bash
   dotnet build Excel.sln
3. Запустите приложение:
   ```bash
   dotnet run --project Excel/Excel.csproj
Альтернативно можно открыть решение в Visual Studio или Rider и запустить его оттуда.

<img width="550" height="128" alt="image" src="https://github.com/user-attachments/assets/19cbaf2e-356a-400e-97ff-78767a1ba146" />

Особенности разбора Excel
Обрабатывается только первый лист рабочей книги.
Для выделения блоков продукции анализируются строки, содержащие слово «продукц». Если следующая ячейка непуста, её значение используется как название продукции.
В расчёт попадают первые три числовые колонки строки (количество, цена, сумма); повторяющиеся подписи строк получают добавочное «(2)», «(3)» и т. д.
Строки с подытогами («Итого», «в т.ч.») и заголовки с римскими числами и двоеточием отбрасываются из сравнения.
Для суммирования используются только строки, оставшиеся после фильтрации; групповой итог выводится, если изменение суммы превышает 5 % или абсолютная дельта отличается от нуля.

<img width="810" height="183" alt="image" src="https://github.com/user-attachments/assets/1155aa50-2e00-4bf3-9ae5-1565e6617fae" />



